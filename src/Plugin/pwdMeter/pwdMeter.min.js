function PasswordMeter(){this.version="1.1.0";this.COMPLEXITY={VERYWEAK:0,WEAK:1,GOOD:2,STRONG:3,VERYSTRONG:4};this.STATUS={FAILED:0,PASSED:1,EXCEEDED:2};this.props=["PasswordLength","UppercaseLetters","LowercaseLetters","Numerics","Symbols","RecommendedPasswordLength","MiddleNumerics","MiddleSymbols","SequentialLetters","SequentialNumerics","KeyboardPatterns","RepeatedSequences","MirroredSequences","BasicRequirements"];this.Complexity={limits:[20,50,60,80,100],value:this.COMPLEXITY.VERYWEAK};this.Score={count:0,adjusted:0,beforeRedundancy:0};this.BasicRequirements={count:0,minimum:3,formula:"TBD",states:3,status:this.STATUS.FAILED,rating:0,factor:1,bonus:10,penalty:-10};this.PasswordLength={count:0,minimum:6,formula:"TBD",states:3,status:this.STATUS.FAILED,basic:true,rating:0,factor:0.5,bonus:10,penalty:-20};this.RecommendedPasswordLength={count:0,minimum:8,formula:"TBD",states:3,status:this.STATUS.FAILED,rating:0,factor:1.2,bonus:10,penalty:-10};this.UppercaseLetters={count:0,minimum:1,formula:"TBD",states:3,status:this.STATUS.FAILED,basic:true,rating:0,factor:0,bonus:10,penalty:-10};this.LowercaseLetters={count:0,minimum:1,formula:"TBD",states:3,status:this.STATUS.FAILED,basic:true,rating:0,factor:0,bonus:10,penalty:-10};this.Numerics={count:0,minimum:1,formula:"TBD",states:3,status:this.STATUS.FAILED,basic:true,rating:0,factor:0,bonus:10,penalty:-10};this.Symbols={count:0,minimum:1,formula:"TBD",states:3,status:this.STATUS.FAILED,basic:true,rating:0,factor:0,bonus:10,penalty:-10};this.MiddleSymbols={count:0,minimum:1,formula:"TBD",states:3,status:this.STATUS.FAILED,rating:0,factor:0,bonus:10,penalty:-10};this.MiddleNumerics={count:0,minimum:1,formula:"TBD",states:3,status:this.STATUS.FAILED,rating:0,factor:0,bonus:10,penalty:-10};this.SequentialLetters={data:"abcdefghijklmnopqrstuvwxyz",length:3,count:0,formula:"TBD",states:2,status:this.STATUS.FAILED,rating:0,factor:-1,bonus:0,penalty:-10};this.SequentialNumerics={data:"0123456789",length:3,count:0,formula:"TBD",states:2,status:this.STATUS.FAILED,rating:0,factor:-1,bonus:0,penalty:-10};this.KeyboardPatterns={data:["qwertzuiop","asdfghjkl","yxcvbnm",'!"§$%&/()=',"1234567890","qaywsxedcrfvtgbzhnujmik,ol.pö-üä+#","qwertyuiop","asdfghjkl","zyxcvbnm","!@#$%^&*()_","1234567890","qazwsxedcrfvtgbyhnujmik,ol.p;/[']\\"],length:4,count:0,formula:"TBD",states:2,status:this.STATUS.FAILED,rating:0,factor:-1,bonus:0,penalty:-10};this.RepeatedSequences={length:3,count:0,formula:"TBD",status:this.STATUS.FAILED,rating:0,factor:0,bonus:0,penalty:-10};this.MirroredSequences={length:3,count:0,formula:"TBD",states:2,status:this.STATUS.FAILED,rating:0,factor:0,bonus:0,penalty:-10};this.Redundancy={value:1,permitted:2,formula:"TBD",status:this.STATUS.FAILED,rating:0};this.SplitPassword={splitPosition:this.RecommendedPasswordLength.minimum,weight1:0.8,weightFull:0.2,part1:"",part1Score:0};this.checkPassword=function(a,p){var u="",e=-1,c=-1,d=-1,r=-1,b=null,n="",g=[],k=[],o=[],t="",m=false,f="",h="",l=0,s=0,q=0;if(a===undefined){a=""}if(p===undefined){p=true}u=a.toLowerCase();for(s=0;s<this.props.length;s++){n=this.props[s];this[n].count=0}this.PasswordLength.count=a.length;this.RecommendedPasswordLength.count=a.length;this.Score.count=this.PasswordLength.count*this.PasswordLength.factor;g=a.split("");for(s=0;s<g.length;s++){if(g[s].match(/[A-Z]/g)){if(e!=-1){if((e+1)==s){this.nConsecutiveUppercaseLetters++;this.nConsecutiveLetters++}}e=s;this.UppercaseLetters.count++}else{if(g[s].match(/[a-z]/g)){if(c!=-1){if((c+1)==s){this.nConsecutiveLowercaseLetters++;this.nConsecutiveLetters++}}c=s;this.LowercaseLetters.count++}else{if(g[s].match(/[0-9]/g)){if(s>0&&s<(g.length-1)){this.MiddleNumerics.count++}if(d!=-1){if((d+1)==s){this.nConsecutiveNumbers++;this.nConsecutiveLetters++}}d=s;this.Numerics.count++}else{if(g[s].match(new RegExp(/[^a-zA-Z0-9]/g))){if(s>0&&s<(g.length-1)){this.MiddleSymbols.count++}if(r!=-1){if((r+1)==s){this.nConsecutiveSymbols++;this.nConsecutiveLetters++}}r=s;this.Symbols.count++}}}}}if(g.length>1){for(s=0;s<g.length;s++){m=false;for(q=s+1;q<g.length;q++){if(g[s]==g[q]){m=true}}if(m===false){k.push(g[s])}}this.Redundancy.value=g.length/k.length}if(this.PasswordLength.count>=this.SequentialLetters.length){for(s=0;s<this.SequentialLetters.data.length-this.SequentialLetters.length;s++){f=this.SequentialLetters.data.substring(s,s+this.SequentialLetters.length);h=this.strReverse(f);if(u.indexOf(f)!=-1){this.SequentialLetters.count++}if(u.indexOf(h)!=-1){this.SequentialLetters.count++}}}if(this.PasswordLength.count>=this.SequentialNumerics.length){for(s=0;s<this.SequentialNumerics.data.length-this.SequentialNumerics.length;s++){f=this.SequentialNumerics.data.substring(s,s+this.SequentialNumerics.length);h=this.strReverse(f);if(u.indexOf(f)!=-1){this.SequentialNumerics.count++}if(u.indexOf(h)!=-1){this.SequentialNumerics.count++}}}if(this.PasswordLength.count>=this.KeyboardPatterns.length){for(s=0;s<this.KeyboardPatterns.data.length;s++){t=this.KeyboardPatterns.data[s];for(q=0;q<t.length-this.KeyboardPatterns.length;q++){f=t.substring(q,q+this.KeyboardPatterns.length);h=this.strReverse(f);if(u.indexOf(f)!=-1&&o[f]===undefined){this.KeyboardPatterns.count++;o[f]=f}if(u.indexOf(h)!=-1&&o[h]===undefined){this.KeyboardPatterns.count++;o[h]=h}}}}if(this.PasswordLength.count>this.RepeatedSequences.length){for(s=0;s<u.length-this.RepeatedSequences.length;s++){f=u.substring(s,s+this.RepeatedSequences.length);l=u.indexOf(f,s+this.RepeatedSequences.length);if(l!=-1){this.RepeatedSequences.count++}}}if(this.PasswordLength.count>this.MirroredSequences.length){for(s=0;s<u.length-this.MirroredSequences.length;s++){f=u.substring(s,s+this.MirroredSequences.length);h=this.strReverse(f);l=u.indexOf(h,s+this.MirroredSequences.length);if(l!=-1){this.MirroredSequences.count++}}}for(s=0;s<this.props.length;s++){n=this.props[s];this.determineStatus(n)}this.Score.beforeRedundancy=this.Score.count;if(this.RecommendedPasswordLength.status!=this.STATUS.EXCEEDED){if(this.Score.count>0){this.Score.count=this.Score.count*(1/this.Redundancy.value)}}if(this.Score.count>100){this.Score.adjusted=100}else{if(this.Score.count<0){this.Score.adjusted=0}else{this.Score.adjusted=this.Score.count}}if(this.PasswordLength.count>this.SplitPassword.splitPosition&&p){b=new PasswordMeter();this.SplitPassword.part1=a.substr(0,this.SplitPassword.splitPosition);b.checkPassword(this.SplitPassword.part1,false);this.SplitPassword.part1Score=b.Score.adjusted;if(this.SplitPassword.part1Score<100){this.Score.count=this.Score.count*this.SplitPassword.weightFull+this.SplitPassword.part1Score*this.SplitPassword.weight1}else{this.SplitPassword.part1Score=this.Score.count}}else{this.SplitPassword.part1Score=this.Score.count}if(this.Score.count>100){this.Score.adjusted=100}else{if(this.Score.count<0){this.Score.adjusted=0}else{this.Score.adjusted=this.Score.count}}for(s=0;s<this.Complexity.limits.length;s++){if(this.Score.adjusted<=this.Complexity.limits[s]){this.Complexity.value=s;break}}return this.Complexity.value};this.determineStatus=function(a){var c=this[a],b=c.states==3?c.count-c.minimum:c.count;c.status=b===0?this.STATUS.PASSED:this.STATUS.FAILED;if(c.states==3&&b>0){c.status=this.STATUS.EXCEEDED}if(c.basic===true&&c.status!=this.STATUS.FAILED){this.BasicRequirements.count++}switch(a){case"RecommendedPasswordLength":c.rating=c.count>=c.minimum?c.bonus+(c.count-c.minimum)*c.factor:c.penalty;this.Score.count+=c.rating;break;case"PasswordLength":c.rating=c.count>=c.minimum?c.bonus+(c.count-c.minimum)*c.factor:c.penalty;this.Score.count+=c.rating;break;case"UppercaseLetters":c.rating=c.count>0?c.bonus+(c.count*c.factor):c.penalty;this.Score.count+=c.rating;break;case"LowercaseLetters":c.rating=c.count>0?c.bonus+(c.count*c.factor):c.penalty;this.Score.count+=c.rating;break;case"Numerics":c.rating=c.count>0?c.bonus+(c.count*c.factor):c.penalty;this.Score.count+=c.rating;break;case"Symbols":c.rating=c.count>0?c.bonus+(c.count*c.factor):c.penalty;this.Score.count+=c.rating;
break;case"MiddleNumerics":c.rating=c.count>0?c.bonus+(c.count*c.factor):c.penalty;this.Score.count+=c.rating;break;case"MiddleSymbols":c.rating=c.count>0?c.bonus+(c.count*c.factor):c.penalty;this.Score.count+=c.rating;break;case"SequentialLetters":c.rating=c.count===0?c.bonus:c.penalty+(c.count*c.factor);this.Score.count+=c.rating;break;case"SequentialNumerics":c.rating=c.count===0?c.bonus:c.penalty+(c.count*c.factor);this.Score.count+=c.rating;break;case"KeyboardPatterns":c.rating=c.count===0?c.bonus:c.penalty+(c.count*c.factor);this.Score.count+=c.rating;break;case"RepeatedSequences":if(this.RecommendedPasswordLength.status!=this.STATUS.EXCEEDED){c.rating=c.count===0?c.bonus:c.penalty+(c.count*c.factor);this.Score.count+=c.rating}break;case"MirroredSequences":if(this.RecommendedPasswordLength.status!=this.STATUS.EXCEEDED){c.rating=c.count===0?c.bonus:c.penalty+(c.count*c.factor);this.Score.count+=c.rating}break;case"BasicRequirements":c.rating=c.status!=this.STATUS.FAILED?c.bonus+(c.count*c.factor):c.penalty;this.Score.count+=c.rating;break;default:break}};this.strReverse=function(c){var b="",a;for(a=0;a<c.length;a++){b=c.charAt(a)+b}return b};this.int2str=function(a){if(a===0){return"0"}else{return parseInt(a,10)}};this.float2str=function(a){if(a===0){return"0.00"}else{return parseFloat(a.toFixed(2))}}};